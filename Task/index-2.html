<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from saeedg110.serv00.net/App/Task/index.php by HTTrack Website Copier/3.x [XR&CO'2017], Tue, 06 May 2025 10:45:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Special Tasks</title>
  <link rel="stylesheet" href="../../../cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
      @import url("../../../external.html?link=https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&amp;display=swap");
        *{margin:0;padding:0;box-sizing:border-box;}body{background-color:#1d283a;color:#ffffff;font-family:"Roboto",sans-serif;display:flex;flex-direction:column;align-items:center;justify-content:start;padding-top:10px;height:100vh;overflow-x:hidden;}.container{width:90%;max-width:500px;margin:10px 0;text-align:center;max-height:89vh;overflow-y:auto;padding-right:0px;}.header img{width:80px;height:auto;margin-bottom:10px;border-radius:50%;box-shadow:0px 4px 8px rgba(0, 0, 0, 0.5);}.header h1{font-size:26px;color:#4CAF50;margin-bottom:15px;letter-spacing:1px;}.reward-card{display:flex;background-color:#333d4d;border-radius:10px;padding:12px;margin:8px 0;align-items:center;justify-content:space-between;position:relative;border:2px solid #4CAF50;}.reward-icon{flex:0 0 40px;display:flex;align-items:center;justify-content:center;}.task-photo{width:40px;height:auto;border-radius:5px;}.reward-details{flex:2;text-align:left;margin-left:10px;}.reward-title{font-size:14px;color:#ffffff;}.reward-amount{font-size:14px;color:#FFD700;display:flex;align-items:center;justify-content:flex-start;}.claim-button{background-color:#4CAF50;color:#ffffff;border:none;padding:6px 12px;border-radius:5px;cursor:pointer;font-weight:bold;font-size:14px;transition:background-color 0.3s;height:35px;flex:0 0 80px;display:flex;align-items:center;justify-content:center;}.loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            width: 12px;
            height: 12px;
            animation: spin 0.8s linear infinite;
            display: inline-block;
            margin-right: 5px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }.notification{position:fixed;top:20px;right:20px;padding:15px;background-color:#4CAF50;color:#ffffff;border-radius:5px;box-shadow:0px 4px 10px rgba(0, 0, 0, 0.2);opacity:0;transform:translateY(-10px);transition:opacity 0.4s ease,transform 0.4s ease;display:flex;align-items:center;gap:8px;z-index:1000;}.notification.show{opacity:1;transform:translateY(0);}.tabs{display:flex;justify-content:space-between;background-color:#333d4d;border-radius:10px;overflow:hidden;margin-top:5px;width:100%;position:relative;}.tab-button{flex:1;padding:10px;color:#ffffff;background-color:#333d4d;font-size:14px;font-weight:500;font-family:"Roboto",sans-serif;cursor:pointer;transition:background-color 0.3s;border:none;display:flex;flex-direction:column;align-items:center;justify-content:center;text-decoration:none;}.tab-content{display:flex;flex-direction:column;align-items:center;}.tab-button i{font-size:24px;margin-bottom:5px;}.tab-button.active,.tab-button:hover{background-color:#4CAF50;}.footer{display:flex;justify-content:space-around;align-items:center;background-color:#1d283a;width:100%;padding:10px 0;position:fixed;bottom:0;box-shadow:0 -2px 5px rgba(0,0,0,0.2);}.footer a{color:#8899a6;text-decoration:none;font-size:14px;text-align:center;display:flex;flex-direction:column;align-items:center;font-weight:500;}.footer a.active{color:#0088cc;}.footer a:hover{color:#0088cc;}.icon{font-size:20px;margin-bottom:4px;}.result-message{font-size:18px;margin-top:20px;color:#4CAF50;}.loader-container{display:flex;justify-content:center;align-items:center;height:100px;}.no-tasks{font-size:16px;color:#ffffff;margin-top:20px;padding:15px;background-color:#333d4d;border-radius:10px;}
  </style>
  <script src="../../../telegram.org/js/telegram-web-app.js"></script>
  <script src="../../../cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.4/lottie.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <div id="sticker-container" style="width: 95px; height: 95px; margin: 0 auto;"></div>
      <h1>Special Tasks</h1>
    </div>
    <div class="tabs">
      <button class="tab-button active"><i class="fas fa-star"></i>Special Tasks</button>
    </div>
    <div id="rewardsContainer">
      <div class="loader-container">
        <div class="loading-spinner" style="width: 30px; height: 30px; border-width: 4px;"></div>
      </div>
    </div>
  </div>
  <div id="claimNotification" class="notification"></div>
  <div class="footer">
    <a href="../../../external.html?link=https://saeedg110.serv00.net/App"><i class="fas fa-house icon"></i>Home</a>
    <a href="index-2.html" class="active"><i class="fas fa-tasks icon"></i>Task</a>
    <a href="../friend.html"><i class="fas fa-user-group icon"></i>Friends</a>
    <a href="../DailySecretCode/index.html" id="airdrop-button"><i class="fas fa-key icon"></i>Daily Code</a>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const tgApp = Telegram.WebApp;
      lottie.loadAnimation({
        container: document.getElementById("sticker-container"),
        renderer: "svg",
        loop: true,
        autoplay: true,
        path: "/App/Task/App/lootbox.json"
      });
      
      tgApp.ready();
      tgApp.setHeaderColor("#1d283a");
      tgApp.setBackgroundColor("#1d283a");
      tgApp.setBottomBarColor("#1d283a");
      
      const userId = tgApp.initDataUnsafe?.user?.id;
      
      async function loadLastClaimData() {
        try {
          const response = await fetch(`/App/Task/App/TaskJS.php?user_id=${userId}`);
          const result = await response.json();
          if (result.status === "success") {
            return result.completed_tasks || [];
          }
          return [];
        } catch (error) {
          console.error("Error loading last claim data:", error);
          return [];
        }
      }
      
      async function loadTasks() {
        const lastClaims = await loadLastClaimData();
        const apiUrl = `specialtasks.json?nocache=${new Date().getTime()}`;
        
        try {
          const response = await fetch(apiUrl);
          const tasks = await response.json();
          
          const rewardsContainer = document.getElementById('rewardsContainer');
          rewardsContainer.innerHTML = '';
          
          if (!tasks || tasks.length === 0) {
            rewardsContainer.innerHTML = '<div class="no-tasks">No Tasks Available</div>';
            return;
          }
          
          tasks.forEach((task) => {
            const card = document.createElement('div');
            card.className = 'reward-card';
            
            const photo = document.createElement('img');
            photo.src = task.photo_url;
            photo.className = 'task-photo';
            
            const iconContainer = document.createElement('div');
            iconContainer.className = 'reward-icon';
            iconContainer.appendChild(photo);
            
            const details = document.createElement('div');
            details.className = 'reward-details';
            
            const title = document.createElement('div');
            title.className = 'reward-title';
            title.textContent = task.title;
            
            const amount = document.createElement('div');
            amount.className = 'reward-amount';
            const starIcon = document.createElement('i');
            starIcon.className = 'fas fa-star';
            amount.appendChild(starIcon);
            amount.append(' ' + task.reward_amount);
            
            details.appendChild(title);
            details.appendChild(amount);
            
            const button = document.createElement('button');
            button.className = 'claim-button';
            
            if (lastClaims.includes(task.task_serial)) {
              button.innerHTML = '<i class="fas fa-check-circle"></i>';
              button.disabled = true;
            } else if (task.is_check_join === "Yes") {
              button.textContent = "Join";
              button.onclick = () => startTask(task, button, true);
            } else {
              button.textContent = "Join";
              button.onclick = () => handleNoCheckJoinTask(task, button);
            }
            
            card.appendChild(iconContainer);
            card.appendChild(details);
            card.appendChild(button);
            rewardsContainer.appendChild(card);
          });
        } catch (error) {
          console.error('Error loading tasks:', error);
          document.getElementById('rewardsContainer').innerHTML = '<div class="no-tasks">No Tasks Available</div>';
        }
      }
      
      function handleNoCheckJoinTask(task, button) {
        if (!button.dataset.firstClick) {
          window.open(task.join_url, "_blank");
          button.innerHTML = '<span class="loading-spinner"></span> Checking...';
          button.disabled = true;
          button.dataset.firstClick = 'true';
          
          setTimeout(() => {
            button.innerHTML = "Join";
            button.disabled = false;
            tgApp.showAlert("Task Not Complete, please join");
            
            button.onclick = () => {
              window.open(task.join_url, "_blank");
              button.innerHTML = '<span class="loading-spinner"></span> Checking...';
              button.disabled = true;
              
              setTimeout(() => {
                button.innerHTML = "Claim";
                button.onclick = () => claimReward(button, task.reward_amount, task.task_serial);
                button.disabled = false;
              }, 10000);
            };
          }, 10000);
        }
      }
      
      async function claimReward(button, rewardAmount, taskSerial) {
        button.disabled = true;
        button.innerHTML = '<span class="loading-spinner"></span> Processing...';
        
        const user = tgApp.initDataUnsafe.user;
        const userId = user ? user.id : null;

        if (!userId) {
          tgApp.showAlert("Error: User not found");
          button.disabled = false;
          button.innerHTML = "Claim";
          return;
        }

        const urlParams = new URLSearchParams(tgApp.initData);
        const hash = urlParams.get("hash");
        urlParams.delete("hash");
        urlParams.sort();
        let dataCheckString = "";
        for (const [key, value] of urlParams.entries()) {
          dataCheckString += key + "=" + value + "\n";
        }
        dataCheckString = dataCheckString.slice(0, -1);

        try {
          const response = await fetch(`reward.php`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              dataCheckString: dataCheckString,
              hash: hash,
              userId: userId,
              task_serial: taskSerial
            })
          });
          const data = await response.json();

          if (data.success) {
            const added = data.balanceData?.added || rewardAmount;
            button.style.display = "none";
            let checkIcon = document.createElement("i");
            checkIcon.className = "fas fa-check-circle";
            checkIcon.style.color = "#4CAF50";
            button.parentNode.appendChild(checkIcon);
            
            document.getElementById("claimNotification").innerHTML = `<i class="fas fa-check-circle"></i> Mission Complete, You Earned ${added}`;
            document.getElementById("claimNotification").classList.add("show");
            setTimeout(() => {
              document.getElementById("claimNotification").classList.remove("show");
            }, 2000);
          } else {
            tgApp.showAlert("Failed: " + (data.message || "Unknown error"));
            button.disabled = false;
            button.innerHTML = "Claim";
          }
        } catch (error) {
          tgApp.showAlert("Connection error");
          button.disabled = false;
          button.innerHTML = "Claim";
        }
      }
      
      function startTask(task, button, checkJoinRequired) {
        window.open(task.join_url, "_blank");
        if (checkJoinRequired) {
          button.textContent = "Check";
          button.onclick = () => checkJoin(task, button);
        }
      }
      
      function checkJoin(task, button) {
        button.innerHTML = '<span class="loading-spinner"></span> Checking...';
        button.disabled = true;
        
        const channelIdentifier = task.channel_identifier || task.join_url.split('../../../external.html?link=https://saeedg110.serv00.net/').pop();
        
        if (!userId || !channelIdentifier) {
          tgApp.showAlert("Error: Missing user or channel data. Please verify.");
          button.disabled = false;
          button.innerHTML = "Join";
          return;
        }
        
        const apiUrl = `/App/Task/App/JoinCheck.php?user_id=${userId}&chat_id=${channelIdentifier}`; //change url
        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            if (data.status === "true" && data.is_joined) {
              button.innerHTML = "Claim";
              button.onclick = () => claimReward(button, task.reward_amount, task.task_serial);
            } else {
              const errorMsg = data.error_message || "Please join the channel first!";
              tgApp.showAlert(errorMsg);
              button.innerHTML = "Join";
              button.onclick = () => startTask(task, button, true);
            }
          })
          .catch(error => {
            tgApp.showAlert("An error occurred while verifying your join status. Please try again.");
            button.innerHTML = "Join";
            button.onclick = () => startTask(task, button, true);
          })
          .finally(() => button.disabled = false);
      }
      
      loadTasks();
    });
  </script>
</body>

<!-- Mirrored from saeedg110.serv00.net/App/Task/index.php by HTTrack Website Copier/3.x [XR&CO'2017], Tue, 06 May 2025 10:45:58 GMT -->
</html>